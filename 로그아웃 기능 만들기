로그아웃 기능 만들기

로그아웃 라우트를 만들고 

로그아웃 하려는 유저를 데이터 베이스에서 찾아서 그 유저의 토큰을 지워 준다.

먼저 로그아웃 라우트는

index.js에서 app.get() 미들웨어로 처리한다

여기서 중요한점은 미들웨어로 auth를 사용한다는 것이다.

auth를 사용함으로서 로그아웃 할 클라이언트를 인증 처리 한후 해당 유저의 데이터를 받을 수 있다.

(* req 객체 프로퍼티로 넘어온 user 데이터 이다.)

app.get('/api/users/logout',auth, (req,res)=>{
    
})

그 내부에서는 로그아웃 하려는 유저를 데이터베이스에서 찾아 토큰을 지워야하므로

모델 내장함수 중 찾아서 업데이트 하는 findOneAndUpdate()메서드를 사용한다.

User.findOneAndUpdate({
    "_id": req.user._id
},{"token": ""}, (err, user)=>{
    if(err) res.json({ success:false, err })
    res.status(200).send({
        success:true
    })
})